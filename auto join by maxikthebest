local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local function createRainbowTextLabel(textLabel)
    local colors = {
        Color3.fromRGB(255, 0, 0),
        Color3.fromRGB(255, 165, 0),
        Color3.fromRGB(255, 255, 0),
        Color3.fromRGB(0, 255, 0),
        Color3.fromRGB(0, 0, 255),
        Color3.fromRGB(75, 0, 130),
        Color3.fromRGB(148, 0, 211),
    }
    local colorIndex = 1
    task.spawn(function()
        while true do
            textLabel.TextColor3 = colors[colorIndex]
            colorIndex = colorIndex % #colors + 1
            task.wait(0.1)
        end
    end)
end

local function createAnnouncement(titleText, subText)
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "MaxikAnnouncement"
    screenGui.ResetOnSpawn = false
    screenGui.IgnoreGuiInset = true
    screenGui.Parent = playerGui

    local mainText = Instance.new("TextLabel")
    mainText.Size = UDim2.new(0, 300, 0, 50)
    mainText.Position = UDim2.new(0, 10, 1, -100)
    mainText.BackgroundTransparency = 0.3
    mainText.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    mainText.Font = Enum.Font.GothamBold
    mainText.TextSize = 20
    mainText.Text = "ðŸ‘‘ " .. titleText .. " ðŸ‘‘"
    mainText.TextWrapped = true
    mainText.Parent = screenGui

    createRainbowTextLabel(mainText)

    local subTextLabel = Instance.new("TextLabel")
    subTextLabel.Size = UDim2.new(0, 300, 0, 25)
    subTextLabel.Position = UDim2.new(0, 10, 1, -50)
    subTextLabel.BackgroundTransparency = 0.3
    subTextLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    subTextLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    subTextLabel.Font = Enum.Font.Gotham
    subTextLabel.TextSize = 14
    subTextLabel.Text = "Thanks for using the script!"
    subTextLabel.TextWrapped = true
    subTextLabel.Parent = screenGui

    task.delay(3, function()
        for i = 1, 10 do
            mainText.TextTransparency = i / 10
            subTextLabel.TextTransparency = i / 10
            mainText.BackgroundTransparency = 0.3 + i / 10
            subTextLabel.BackgroundTransparency = 0.3 + i / 10
            task.wait(0.05)
        end
        screenGui:Destroy()
    end)
end

local function startAnnouncer(title, subtitle)
    task.spawn(function()
        while true do
            createAnnouncement(title, subtitle)
            task.wait(1)
        end
    end)
end

local function waitForGuiToBeEnabled(timeout)
    local gui = playerGui:WaitForChild("PartyCreation", timeout)
    if not gui then return false end
    if gui:IsA("ScreenGui") and gui.Enabled then return true end

    local success = false
    local connection = gui:GetPropertyChangedSignal("Enabled"):Connect(function()
        if gui.Enabled then
            success = true
            connection:Disconnect()
        end
    end)

    local start = tick()
    repeat task.wait() until success or tick() - start > timeout
    if not success and connection then connection:Disconnect() end
    return success
end

local groupedPositions = {
    {
        Vector3.new(43.28, 3.60, 100.56),
        Vector3.new(44.24, 3.60, 115.73),
        Vector3.new(43.71, 3.60, 130.27),
        Vector3.new(43.85, 3.60, 146.27)
    },
    {
        Vector3.new(43.28, 3.60, 100.56),
        Vector3.new(44.24, 3.60, 115.73),
        Vector3.new(43.71, 3.60, 130.27),
        Vector3.new(43.85, 3.60, 146.27)
    }
}

if game.PlaceId == 116495829188952 then
    local character = player.Character or player.CharacterAdded:Wait()
    local hrp = character:WaitForChild("HumanoidRootPart")

    RunService.Stepped:Connect(function()
        for _, part in ipairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end)

    task.spawn(function()
        while true do
            for _, positionGroup in ipairs(groupedPositions) do
                local startTime = tick()
                while tick() - startTime < 5 do
                    for _, pos in ipairs(positionGroup) do
                        hrp.CFrame = CFrame.new(pos)

                         local args = {
                        [1] = {
                            maxMembers = 1,
                            gameMode = "Normal",
                            trainId = "default"
                        }
                    }

                    ReplicatedStorage:WaitForChild("Shared")
                        :WaitForChild("Network")
                        :WaitForChild("RemoteEvent")
                        :WaitForChild("CreateParty")
                        :FireServer(unpack(args))

                        task.wait(0.1)
                    end
                end

                if waitForGuiToBeEnabled(2) then
                    return
                end
            end
        end
    end)

    startAnnouncer("MaxikTheBest made this!", "Thanks for using this!")
else
    startAnnouncer("Incorrect Game", "Please use this only in dead rails lobby!")
end
